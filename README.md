I got tired of copying/modifying this so I put it in one place.
